<style>
  :root {
    --color-active: blue;
    --color-background: #eee;
  }
  body {
    font-family: Helvetica, Arial, sans-serif;
    background-color: var(--color-background);
  }

  .listicle {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    padding: 0;
    gap: 0.4em;
  }

  .status-assign-button {
    text-align: left;
    border: 0;
    padding: 0.4em 0.6em;
    background-color: #fff;
    cursor: pointer;
    transition: font-weight 0.2s ease-out;
  }
  .status-assign-button:hover {
    font-weight: 700;
  }

  .content-container:not(.active) {
    display: none;
  }

  #status-edit {
    list-style: none;
    padding: 0;
  }

  #status-edit li {
    display: flex;
    flex-direction: row;
  }

  #status-edit input {
    border: 1px solid #aaa;
  }

  #status-edit .status-edit-marker {
    width: 2em;
    text-align: center;
  }
</style>
<main class="content-container" id="assign-status-content">
  <h3>Assign Status</h3>
  <ul class="listicle" id="status-apply"></ul>
</main>
<main class="content-container" id="config-content">
  <h3>Configure</h3>
  <ul class="listicle" id="status-edit"></ul>
</main>
<script>
  // functions exist before anything else so they can be called
  const tabClick = (e) => {
    const id = e.target.id;
    document.querySelectorAll("[id$='-content']").forEach((elem) => {
      elem.classList.remove("active");
    });

    document.querySelectorAll(`#${id}`).forEach((elem) => {
      elem.classList.add("active");
    });
  };

  // get options from code.js
  const options = [];
  window.onmessage = (event) => {
    const msg = event.data.pluginMessage;

    switch (msg.type) {
      case "command":
        document
          .querySelector(`#${msg.command}-content`)
          .classList.add("active");
        break;
      case "options":
        options.push(...msg.options);
        break;
    }

    document.querySelectorAll(".tab").forEach((elem) => {
      elem.addEventListener("click", tabClick, false);
    });

    options.map((option) => {
      // add options to select
      const elem = document.createElement("button");
      elem.textContent = `${option.marker} ${option.label}`;
      elem.classList.add("status-assign-button");
      elem.onclick = () =>
        parent.postMessage(
          { pluginMessage: { fn: "setTitle", state: option } },
          "*"
        );
      document.querySelector("#status-apply").appendChild(elem);

      // add options to configure
      const markerInput = document.createElement("input");
      markerInput.value = option.marker;
      markerInput.classList.add("status-edit-marker");

      const labelInput = document.createElement("input");
      labelInput.value = option.label;
      labelInput.classList.add("status-edit-label");

      const container = document.createElement("li");
      container.appendChild(markerInput);
      container.appendChild(labelInput);

      document.querySelector("#status-edit").appendChild(container);
    });
  };
</script>
